# Solution 1

SELECT contragent FROM banks
WHERE contragent IN (SELECT contragent FROM banks 
WHERE typeraiting = 'GLOBAL' AND to_char(raitingdate, 'YYYY/MM/DD') LIKE '2023%') AND typeraiting = 'RU'
GROUP BY contragent;




# Solution 2

SELECT banks.contragent FROM banks 
INNER JOIN (SELECT contragent FROM banks
WHERE typeraiting = 'GLOBAL' AND to_char(raitingdate, 'YYYY/MM/DD') LIKE '2023%') AS a ON a.contragent = banks.contragent 
WHERE typeraiting = 'RU' AND to_char(raitingdate, 'YYYY/MM/DD') LIKE '2023%';
